<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${practica.id != null ? 'Editar Pr√°ctica' : 'Nueva Pr√°ctica'}">Editar Pr√°ctica</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-5">
    <h2 class="mb-4" th:text="${practica.id != null ? 'Editar Pr√°ctica' : 'Nueva Pr√°ctica'}">Editar Pr√°ctica</h2>

    <!-- Volver al dashboard seg√∫n rol -->
    <div class="mb-3">
        <a th:href="${rol == 'profesor'} ? @{/dashboard-profesor} : @{/practicas/estudiante/dashboard}"
           class="btn btn-secondary">Volver al dashboard</a>
    </div>

    <!-- Mensajes flash opcionales -->
    <div th:if="${mensaje}" class="alert alert-success" th:text="${mensaje}"></div>
    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

    <!-- Formulario -->
    <form th:object="${practica}"
          th:action="@{${practica.id != null ? '/practicas/actualizar' : '/practicas/guardar'}(rol=${rol})}"
          method="post" class="card shadow-sm p-4 bg-white">

        <!-- ID oculto en edici√≥n -->
        <input type="hidden" th:if="${practica.id != null}" th:field="*{id}"/>

        <!-- ===== Datos del Estudiante ===== -->
        <h5 class="mt-2">Datos del Estudiante</h5>
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">Nombres</label>
                <input type="text" th:field="*{estudianteNombre}" class="form-control" required/>
            </div>
            <div class="col-md-6">
                <label class="form-label">Apellidos</label>
                <input type="text" th:field="*{estudianteApellido}" class="form-control" required/>
            </div>
            <div class="col-md-6">
                <label class="form-label">Carrera</label>
                <input type="text" th:field="*{estudianteCarrera}" class="form-control" required/>
            </div>
            <!-- üöÄ Nuevo: Email obligatorio -->
            <div class="col-md-6">
                <label class="form-label">Email</label>
                <input type="email" th:field="*{estudianteEmail}" class="form-control"
                       placeholder="ejemplo@correo.com" required/>
            </div>
        </div>

        <!-- ===== Detalles de la Pr√°ctica ===== -->
        <h5 class="mt-4">Detalles de la Pr√°ctica</h5>
        <div class="row g-3">
            <div class="col-md-4">
                <label class="form-label">Fecha de Inicio</label>
                <input type="date" th:field="*{fechaInicio}" class="form-control" required/>
            </div>
            <div class="col-md-4">
                <label class="form-label">Fecha de T√©rmino</label>
                <input type="date" th:field="*{fechaTermino}" class="form-control" required/>
            </div>
            <div class="col-md-4">
                <label class="form-label">Estado</label>
                <input type="text" th:field="*{estado}" class="form-control" placeholder="En curso / Aprobada / Rechazada"/>
            </div>
            <div class="col-12">
                <label class="form-label">Descripci√≥n de Actividades</label>
                <textarea th:field="*{descripcionActividades}" class="form-control" rows="4"></textarea>
            </div>
        </div>

        <!-- ===== Datos de la Empresa ===== -->
        <h5 class="mt-4">Datos de la Empresa</h5>
        <div class="row g-3">
            <div class="col-md-4">
                <label class="form-label">Nombre</label>
                <input type="text" th:field="*{empresaNombre}" class="form-control"/>
            </div>
            <div class="col-md-5">
                <label class="form-label">Direcci√≥n</label>
                <input type="text" th:field="*{empresaDireccion}" class="form-control"/>
            </div>
            <div class="col-md-3">
                <label class="form-label">Tel√©fono</label>
                <input type="text" th:field="*{empresaTelefono}" class="form-control"/>
            </div>
        </div>

        <!-- ===== Jefe Directo ===== -->
        <h5 class="mt-4">Jefe Directo</h5>
        <div class="row g-3">
            <div class="col-md-4">
                <label class="form-label">Nombres</label>
                <input type="text" th:field="*{jefeNombre}" class="form-control"/>
            </div>
            <div class="col-md-4">
                <label class="form-label">Apellidos</label>
                <input type="text" th:field="*{jefeApellido}" class="form-control"/>
            </div>
            <div class="col-md-4">
                <label class="form-label">Tel√©fono</label>
                <input type="text" th:field="*{jefeTelefono}" class="form-control"/>
            </div>
            <div class="col-md-6">
                <label class="form-label">Email</label>
                <input type="email" th:field="*{jefeEmail}" class="form-control"/>
            </div>
        </div>

        <!-- ===== Profesor Supervisor ===== -->
        <h5 class="mt-4">Profesor Supervisor</h5>
        <div class="row g-3">
            <div class="col-md-4">
                <label class="form-label">Nombres</label>
                <input type="text" th:field="*{profesorNombre}" class="form-control"/>
            </div>
            <div class="col-md-4">
                <label class="form-label">Apellidos</label>
                <input type="text" th:field="*{profesorApellido}" class="form-control"/>
            </div>
            <div class="col-md-4">
                <label class="form-label">Tel√©fono</label>
                <input type="text" th:field="*{profesorTelefono}" class="form-control"/>
            </div>
            <div class="col-md-6">
                <label class="form-label">Email</label>
                <input type="email" th:field="*{profesorEmail}" class="form-control" required/>
            </div>
        </div>

        <div class="mt-4 d-flex gap-2">
            <button type="submit" class="btn btn-success">Guardar</button>
            <a th:href="${rol == 'profesor'} ? @{/dashboard-profesor} : @{/practicas/estudiante/dashboard}"
               class="btn btn-outline-secondary">Cancelar</a>
        </div>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
